<!--<!DOCTYPE html>-->
<!--<html lang="uk"-->
<!--      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"-->
<!--      xmlns:th="http://www.thymeleaf.org"-->
<!--      layout:decorate="~{layout}">-->
<!--<head>-->
<!--    <title>Список товарів</title>-->
<!--</head>-->
<!--<body>-->
<!--<div layout:fragment="content" class="flex flex-col items-center">-->
<!--    <h1 class="text-3xl font-bold mb-6 text-green-700">Список товарів</h1>-->

<!--    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">-->
<!--        <div th:each="product : ${products}"-->
<!--             th:replace="components/product-card :: productCard(product = ${product})"></div>-->
<!--    </div>-->
<!--</div>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="uk"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{layout}">
<head>
    <meta charset="utf-8"/>
    <title>Список товарів</title>
</head>
<body>
<div layout:fragment="content" class="flex flex-col items-center">
    <h1 class="text-3xl font-bold mb-6 text-green-700">Список товарів</h1>

    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        <div th:each="product : ${products}">
            <div th:if="${product != null}"
                 class="bg-white h-100 rounded-3xl shadow-md hover:shadow-xl transition-all transform hover:-translate-y-1 hover:scale-105 w-72 flex flex-col overflow-hidden">

                <div class="w-full aspect-[4/3] bg-green-50 flex items-center justify-center overflow-hidden">
                    <div th:if="${product.image != null}">
                        <img th:src="@{'/' + ${uploadDir} + '/medium/' + ${product.image}}"
                             th:alt="${product.name} + ' image'"
                             class="w-full h-40 object-cover"/>
                    </div>
                </div>

                <div class="p-4 flex flex-col flex-1 justify-between">
                    <div class="flex flex-col items-center flex-1">
                        <h2 class="text-lg font-semibold text-gray-800 line-clamp-1 text-center mb-1"
                            th:text="${product.name} ?: 'Без назви'">Назва товару</h2>

                        <span th:text="${product.categoryName} != null ? ${product.categoryName} : '—'"
                              class="text-xs font-medium text-green-700 bg-green-100 px-3 py-1 rounded-full mb-2">
                            Категорія
                        </span>

                        <p class="text-gray-500 text-sm text-center mb-4 line-clamp-1 overflow-hidden"
                           th:text="${product.description} ?: 'Опис відсутній'">
                            Опис товару
                        </p>
                    </div>

                    <div class="flex gap-2 mt-2">
                        <a th:href="@{/products/{slug}(slug=${product.slug})}"
                           class="flex-1 text-center py-2 rounded-lg bg-gradient-to-r from-green-500 to-green-600 text-white font-semibold hover:from-green-600 hover:to-green-700 transition">
                            Деталі
                        </a>

                        <button type="button"
                                class="flex-1 flex items-center justify-center gap-2 py-2 rounded-lg bg-gradient-to-r from-yellow-400 to-yellow-500 text-white font-semibold hover:from-yellow-500 hover:to-yellow-600 transition">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                                 viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                      d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2 7h14l-2-7M9 21a1 1 0 100-2 1 1 0 000 2zm6 0a1 1 0 100-2 1 1 0 000 2z"/>
                            </svg>
                            В кошик
                        </button>
                    </div>
                </div>
            </div>

            <div th:if="${product == null}" class="bg-red-50 rounded-2xl p-5 w-72 border border-red-200">
                <p class="text-red-600 font-medium text-center">Помилка: товар = null</p>
            </div>
        </div>
    </div>

    <div th:if="${page != null}" class="mt-8 flex flex-col items-center gap-4">
        <div class="flex items-center gap-2">
            <a th:href="@{/products/list(page=${page.currentPage}, size=${page.pageSize})}"
               th:if="${page.hasPrevious}"
               class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition font-semibold">
                ← Попередня
            </a>
            <span th:unless="${page.hasPrevious}"
                  class="px-4 py-2 bg-gray-300 text-gray-500 rounded-lg cursor-not-allowed">
                ← Попередня
            </span>

            <div class="flex gap-2">
                <a th:href="@{/products/list(page=1, size=${page.pageSize})}"
                   th:class="${0 == page.currentPage} ?
                             'px-4 py-2 bg-green-600 text-white rounded-lg font-semibold' :
                             'px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition font-semibold'"
                   th:text="1">
                    1
                </a>

                <span th:if="${page.currentPage > 2}"
                      class="px-2 py-2 text-gray-500">
                    ...
                </span>

                <th:block th:each="pageNum : ${#numbers.sequence(
                    T(java.lang.Math).max(1, page.currentPage - 1),
                    T(java.lang.Math).min(page.totalPages - 2, page.currentPage + 1)
                )}">
                    <a th:href="@{/products/list(page=${pageNum+1}, size=${page.pageSize})}"
                       th:class="${pageNum == page.currentPage} ?
                                 'px-4 py-2 bg-green-600 text-white rounded-lg font-semibold' :
                                 'px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition font-semibold'"
                       th:text="${pageNum + 1}">
                        [[${pageNum + 1}]]
                    </a>
                </th:block>

                <span th:if="${page.currentPage < page.totalPages - 3}"
                      class="px-2 py-2 text-gray-500">
                    ...
                </span>

                <a th:if="${page.totalPages > 1}"
                   th:href="@{/products/list(page=${page.totalPages - 1}, size=${page.pageSize})}"
                   th:class="${(page.totalPages - 1) == page.currentPage} ?
                             'px-4 py-2 bg-green-600 text-white rounded-lg font-semibold' :
                             'px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition font-semibold'"
                   th:text="${page.totalPages}">
                    [[${page.totalPages}]]
                </a>
            </div>

            <a th:href="@{/products/list(page=${page.currentPage + 2}, size=${page.pageSize})}"
               th:if="${page.hasNext}"
               class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition font-semibold">
                Наступна →
            </a>
            <span th:unless="${page.hasNext}"
                  class="px-4 py-2 bg-gray-300 text-gray-500 rounded-lg cursor-not-allowed">
                Наступна →
            </span>
        </div>

        <div class="text-sm text-gray-600">
            <span>Сторінка <span th:text="${page.currentPage + 1}">1</span> з <span
                    th:text="${page.totalPages}">1</span></span>
            <span class="mx-2">|</span>
            <span>Всього товарів: <span th:text="${page.totalElements}">0</span></span>
            <span class="mx-2">|</span>
            <span>На сторінці: <span th:text="${page.pageSize}">12</span></span>
        </div>
    </div>
</div>
</body>
</html>
